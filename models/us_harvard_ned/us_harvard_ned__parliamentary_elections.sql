{{
    config(
        alias="parliamentary_elections",
        schema="us_harvard_ned",
        materialized="table",
        partition_by={
            "field": "year",
            "data_type": "int64",
            "range": {
                "start": 1789,
                "end": 2023,
                "interval": 1,
            },
        },
        cluster_by=["country_id"],
    )
}}

select
    safe_cast(country_id as string) country_id,
    safe_cast(year as int64) year,
    safe_cast(month as int64) month,
    safe_cast(type as string) type,
    safe_cast(case when date = '' or date is null then null else date end as date) date,
    safe_cast(source as string) source,
    safe_cast(total_seats as int64) total_seats,
    safe_cast(party_1 as string) party_1,
    safe_cast(seats_1 as int64) seats_1,
    safe_cast(seat_share_1 as float64) seat_share_1,
    safe_cast(party_2 as string) party_2,
    safe_cast(seats_2 as int64) seats_2,
    safe_cast(seat_share_2 as float64) seat_share_2,
    safe_cast(party_3 as string) party_3,
    safe_cast(seats_3 as int64) seats_3,
    safe_cast(seat_share_3 as float64) seat_share_3,
    safe_cast(party_4 as string) party_4,
    safe_cast(seats_4 as int64) seats_4,
    safe_cast(seat_share_4 as float64) seat_share_4,
    safe_cast(party_5 as string) party_5,
    safe_cast(seats_5 as int64) seats_5,
    safe_cast(seat_share_5 as float64) seat_share_5,
    safe_cast(party_6 as string) party_6,
    safe_cast(seats_6 as int64) seats_6,
    safe_cast(seat_share_6 as float64) seat_share_6,
    safe_cast(party_7 as string) party_7,
    safe_cast(seats_7 as int64) seats_7,
    safe_cast(seat_share_7 as float64) seat_share_7,
    safe_cast(party_8 as string) party_8,
    safe_cast(seats_8 as int64) seats_8,
    safe_cast(seat_share_8 as float64) seat_share_8,
    safe_cast(party_9 as string) party_9,
    safe_cast(seats_9 as int64) seats_9,
    safe_cast(seat_share_9 as float64) seat_share_9,
    safe_cast(party_10 as string) party_10,
    safe_cast(seats_10 as int64) seats_10,
    safe_cast(seat_share_10 as float64) seat_share_10,
    safe_cast(party_11 as string) party_11,
    safe_cast(seats_11 as int64) seats_11,
    safe_cast(seat_share_11 as float64) seat_share_11,
    safe_cast(party_12 as string) party_12,
    safe_cast(seats_12 as int64) seats_12,
    safe_cast(seat_share_12 as float64) seat_share_12,
    safe_cast(party_13 as string) party_13,
    safe_cast(seats_13 as int64) seats_13,
    safe_cast(seat_share_13 as float64) seat_share_13,
    safe_cast(party_14 as string) party_14,
    safe_cast(seats_14 as int64) seats_14,
    safe_cast(seat_share_14 as float64) seat_share_14,
    safe_cast(party_15 as string) party_15,
    safe_cast(seats_15 as int64) seats_15,
    safe_cast(seat_share_15 as float64) seat_share_15,
    safe_cast(party_16 as string) party_16,
    safe_cast(seats_16 as int64) seats_16,
    safe_cast(seat_share_16 as float64) seat_share_16,
    safe_cast(party_17 as string) party_17,
    safe_cast(seats_17 as int64) seats_17,
    safe_cast(seat_share_17 as float64) seat_share_17,
    safe_cast(party_18 as string) party_18,
    safe_cast(seats_18 as int64) seats_18,
    safe_cast(seat_share_18 as float64) seat_share_18,
    safe_cast(party_19 as string) party_19,
    safe_cast(seats_19 as int64) seats_19,
    safe_cast(seat_share_19 as float64) seat_share_19,
    safe_cast(party_20 as string) party_20,
    safe_cast(seats_20 as int64) seats_20,
    safe_cast(seat_share_20 as float64) seat_share_20,
    safe_cast(party_21 as string) party_21,
    safe_cast(seats_21 as int64) seats_21,
    safe_cast(seat_share_21 as float64) seat_share_21,
    safe_cast(party_22 as string) party_22,
    safe_cast(seats_22 as int64) seats_22,
    safe_cast(seat_share_22 as float64) seat_share_22,
    safe_cast(party_23 as string) party_23,
    safe_cast(seats_23 as int64) seats_23,
    safe_cast(seat_share_23 as float64) seat_share_23,
    safe_cast(party_24 as string) party_24,
    safe_cast(seats_24 as int64) seats_24,
    safe_cast(seat_share_24 as float64) seat_share_24,
    safe_cast(party_25 as string) party_25,
    safe_cast(seats_25 as int64) seats_25,
    safe_cast(seat_share_25 as float64) seat_share_25,
    safe_cast(party_26 as string) party_26,
    safe_cast(seats_26 as int64) seats_26,
    safe_cast(seat_share_26 as float64) seat_share_26,
    safe_cast(party_27 as string) party_27,
    safe_cast(seats_27 as int64) seats_27,
    safe_cast(seat_share_27 as float64) seat_share_27,
    safe_cast(party_28 as string) party_28,
    safe_cast(seats_28 as int64) seats_28,
    safe_cast(seat_share_28 as float64) seat_share_28,
    safe_cast(party_29 as string) party_29,
    safe_cast(seats_29 as int64) seats_29,
    safe_cast(seat_share_29 as float64) seat_share_29,
    safe_cast(party_30 as string) party_30,
    safe_cast(seats_30 as int64) seats_30,
    safe_cast(seat_share_30 as float64) seat_share_30,
    safe_cast(party_31 as string) party_31,
    safe_cast(seats_31 as int64) seats_31,
    safe_cast(seat_share_31 as float64) seat_share_31,
    safe_cast(party_32 as string) party_32,
    safe_cast(seats_32 as int64) seats_32,
    safe_cast(seat_share_32 as float64) seat_share_32,
    safe_cast(party_33 as string) party_33,
    safe_cast(seats_33 as int64) seats_33,
    safe_cast(seat_share_33 as float64) seat_share_33,
    safe_cast(party_34 as string) party_34,
    safe_cast(seats_34 as int64) seats_34,
    safe_cast(seat_share_34 as float64) seat_share_34,
    safe_cast(party_35 as string) party_35,
    safe_cast(seats_35 as int64) seats_35,
    safe_cast(seat_share_35 as float64) seat_share_35,
    safe_cast(party_36 as string) party_36,
    safe_cast(seats_36 as int64) seats_36,
    safe_cast(seat_share_36 as float64) seat_share_36,
    safe_cast(party_37 as string) party_37,
    safe_cast(seats_37 as int64) seats_37,
    safe_cast(seat_share_37 as float64) seat_share_37,
    safe_cast(party_38 as string) party_38,
    safe_cast(seats_38 as int64) seats_38,
    safe_cast(seat_share_38 as float64) seat_share_38,
    safe_cast(party_39 as string) party_39,
    safe_cast(seats_39 as int64) seats_39,
    safe_cast(seat_share_39 as float64) seat_share_39,
    safe_cast(party_40 as string) party_40,
    safe_cast(seats_40 as int64) seats_40,
    safe_cast(seat_share_40 as float64) seat_share_40,
    safe_cast(party_41 as string) party_41,
    safe_cast(seats_41 as int64) seats_41,
    safe_cast(seat_share_41 as float64) seat_share_41,
    safe_cast(party_42 as string) party_42,
    safe_cast(seats_42 as int64) seats_42,
    safe_cast(seat_share_42 as float64) seat_share_42,
    safe_cast(party_43 as string) party_43,
    safe_cast(seats_43 as int64) seats_43,
    safe_cast(seat_share_43 as float64) seat_share_43,
    safe_cast(party_44 as string) party_44,
    safe_cast(seats_44 as int64) seats_44,
    safe_cast(seat_share_44 as float64) seat_share_44,
    safe_cast(party_45 as string) party_45,
    safe_cast(seats_45 as int64) seats_45,
    safe_cast(seat_share_45 as float64) seat_share_45,
    safe_cast(party_46 as string) party_46,
    safe_cast(seats_46 as int64) seats_46,
    safe_cast(seat_share_46 as float64) seat_share_46,
    safe_cast(party_47 as string) party_47,
    safe_cast(seats_47 as int64) seats_47,
    safe_cast(seat_share_47 as float64) seat_share_47,
    safe_cast(party_48 as string) party_48,
    safe_cast(seats_48 as int64) seats_48,
    safe_cast(seat_share_48 as float64) seat_share_48,
    safe_cast(party_49 as string) party_49,
    safe_cast(seats_49 as int64) seats_49,
    safe_cast(seat_share_49 as float64) seat_share_49,
    safe_cast(party_50 as string) party_50,
    safe_cast(seats_50 as int64) seats_50,
    safe_cast(seat_share_50 as float64) seat_share_50,
    safe_cast(party_51 as string) party_51,
    safe_cast(seats_51 as int64) seats_51,
    safe_cast(seat_share_51 as float64) seat_share_51,
    safe_cast(party_52 as string) party_52,
    safe_cast(seats_52 as int64) seats_52,
    safe_cast(seat_share_52 as float64) seat_share_52,
    safe_cast(party_53 as string) party_53,
    safe_cast(seats_53 as int64) seats_53,
    safe_cast(seat_share_53 as float64) seat_share_53,
    safe_cast(party_54 as string) party_54,
    safe_cast(seats_54 as int64) seats_54,
    safe_cast(seat_share_54 as float64) seat_share_54,
    safe_cast(party_55 as string) party_55,
    safe_cast(seats_55 as int64) seats_55,
    safe_cast(seat_share_55 as float64) seat_share_55,
    safe_cast(party_56 as string) party_56,
    safe_cast(seats_56 as int64) seats_56,
    safe_cast(seat_share_56 as float64) seat_share_56,
    safe_cast(party_57 as string) party_57,
    safe_cast(seats_57 as int64) seats_57,
    safe_cast(seat_share_57 as float64) seat_share_57,
    safe_cast(party_58 as string) party_58,
    safe_cast(seats_58 as int64) seats_58,
    safe_cast(seat_share_58 as float64) seat_share_58,
    safe_cast(party_59 as string) party_59,
    safe_cast(seats_59 as int64) seats_59,
    safe_cast(seat_share_59 as float64) seat_share_59,
    safe_cast(party_60 as string) party_60,
    safe_cast(seats_60 as int64) seats_60,
    safe_cast(seat_share_60 as float64) seat_share_60,
    safe_cast(party_61 as string) party_61,
    safe_cast(seats_61 as int64) seats_61,
    safe_cast(seat_share_61 as float64) seat_share_61,
    safe_cast(party_62 as string) party_62,
    safe_cast(seats_62 as int64) seats_62,
    safe_cast(seat_share_62 as float64) seat_share_62,
    safe_cast(party_63 as string) party_63,
    safe_cast(seats_63 as int64) seats_63,
    safe_cast(seat_share_63 as float64) seat_share_63,
    safe_cast(party_64 as string) party_64,
    safe_cast(seats_64 as int64) seats_64,
    safe_cast(seat_share_64 as float64) seat_share_64,
    safe_cast(party_65 as string) party_65,
    safe_cast(seats_65 as int64) seats_65,
    safe_cast(seat_share_65 as float64) seat_share_65,
    safe_cast(party_66 as string) party_66,
    safe_cast(seats_66 as int64) seats_66,
    safe_cast(seat_share_66 as float64) seat_share_66,
    safe_cast(party_67 as string) party_67,
    safe_cast(seats_67 as int64) seats_67,
    safe_cast(seat_share_67 as float64) seat_share_67,
    safe_cast(party_68 as string) party_68,
    safe_cast(seats_68 as int64) seats_68,
    safe_cast(seat_share_68 as float64) seat_share_68,
    safe_cast(party_69 as string) party_69,
    safe_cast(seats_69 as int64) seats_69,
    safe_cast(seat_share_69 as float64) seat_share_69,
    safe_cast(party_70 as string) party_70,
    safe_cast(seats_70 as int64) seats_70,
    safe_cast(seat_share_70 as float64) seat_share_70,
    safe_cast(party_71 as string) party_71,
    safe_cast(seats_71 as int64) seats_71,
    safe_cast(seat_share_71 as float64) seat_share_71,
    safe_cast(party_72 as string) party_72,
    safe_cast(seats_72 as int64) seats_72,
    safe_cast(seat_share_72 as float64) seat_share_72,
    safe_cast(party_73 as string) party_73,
    safe_cast(seats_73 as int64) seats_73,
    safe_cast(seat_share_73 as float64) seat_share_73,
    safe_cast(party_74 as string) party_74,
    safe_cast(seats_74 as int64) seats_74,
    safe_cast(seat_share_74 as float64) seat_share_74,
    safe_cast(flag_constituent as bool) flag_constituent,
    safe_cast(flag_inconsequential as bool) flag_inconsequential,
    safe_cast(flag_inconsequential_note as string) flag_inconsequential_note,
    safe_cast(flag_coup as bool) flag_coup,
    safe_cast(flag_vacant_seats as bool) flag_vacant_seats,
    safe_cast(flag_vacant_seats_nb as int64) flag_vacant_seats_nb,
    safe_cast(flag_appointed as bool) flag_appointed,
    safe_cast(flag_appointed_nb as int64) flag_appointed_nb,
    safe_cast(flag_non_partisan as bool) flag_non_partisan
from {{ set_datalake_project("us_harvard_ned_staging.parliamentary_elections") }} as t
