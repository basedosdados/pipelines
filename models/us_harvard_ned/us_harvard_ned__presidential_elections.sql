{{
    config(
        alias="presidential_elections",
        schema="us_harvard_ned",
        materialized="table",
        partition_by={
            "field": "year",
            "data_type": "int64",
            "range": {
                "start": 1789,
                "end": 2023,
                "interval": 1,
            },
        },
        cluster_by=["country_id"],
    )
}}

select
    safe_cast(country_id as string) country_id,
    safe_cast(year as int64) year,
    safe_cast(month as int64) month,
    safe_cast(type as string) type,
    safe_cast(case when date = '' or date is null then null else date end as date) date,
    safe_cast(source as string) source,
    safe_cast(candidate_1 as string) candidate_1,
    safe_cast(party_1 as string) party_1,
    safe_cast(votes1_1 as int64) votes1_1,
    safe_cast(votes2_1 as int64) votes2_1,
    safe_cast(vote_share1_1 as float64) vote_share1_1,
    safe_cast(vote_share2_1 as float64) vote_share2_1,
    safe_cast(e_votes_1 as int64) e_votes_1,
    safe_cast(e_vote_share_1 as float64) e_vote_share_1,
    safe_cast(candidate_2 as string) candidate_2,
    safe_cast(party_2 as string) party_2,
    safe_cast(votes1_2 as int64) votes1_2,
    safe_cast(votes2_2 as int64) votes2_2,
    safe_cast(vote_share1_2 as float64) vote_share1_2,
    safe_cast(vote_share2_2 as float64) vote_share2_2,
    safe_cast(e_votes_2 as int64) e_votes_2,
    safe_cast(e_vote_share_2 as float64) e_vote_share_2,
    safe_cast(candidate_3 as string) candidate_3,
    safe_cast(party_3 as string) party_3,
    safe_cast(votes1_3 as int64) votes1_3,
    safe_cast(votes2_3 as int64) votes2_3,
    safe_cast(vote_share1_3 as float64) vote_share1_3,
    safe_cast(vote_share2_3 as float64) vote_share2_3,
    safe_cast(e_votes_3 as int64) e_votes_3,
    safe_cast(e_vote_share_3 as float64) e_vote_share_3,
    safe_cast(candidate_4 as string) candidate_4,
    safe_cast(party_4 as string) party_4,
    safe_cast(votes1_4 as int64) votes1_4,
    safe_cast(votes2_4 as int64) votes2_4,
    safe_cast(vote_share1_4 as float64) vote_share1_4,
    safe_cast(vote_share2_4 as float64) vote_share2_4,
    safe_cast(e_votes_4 as int64) e_votes_4,
    safe_cast(e_vote_share_4 as float64) e_vote_share_4,
    safe_cast(candidate_5 as string) candidate_5,
    safe_cast(party_5 as string) party_5,
    safe_cast(votes1_5 as int64) votes1_5,
    safe_cast(votes2_5 as int64) votes2_5,
    safe_cast(vote_share1_5 as float64) vote_share1_5,
    safe_cast(vote_share2_5 as float64) vote_share2_5,
    safe_cast(e_votes_5 as int64) e_votes_5,
    safe_cast(e_vote_share_5 as float64) e_vote_share_5,
    safe_cast(candidate_6 as string) candidate_6,
    safe_cast(party_6 as string) party_6,
    safe_cast(votes1_6 as int64) votes1_6,
    safe_cast(votes2_6 as int64) votes2_6,
    safe_cast(vote_share1_6 as float64) vote_share1_6,
    safe_cast(vote_share2_6 as float64) vote_share2_6,
    safe_cast(e_votes_6 as int64) e_votes_6,
    safe_cast(e_vote_share_6 as float64) e_vote_share_6,
    safe_cast(candidate_7 as string) candidate_7,
    safe_cast(party_7 as string) party_7,
    safe_cast(votes1_7 as int64) votes1_7,
    safe_cast(votes2_7 as int64) votes2_7,
    safe_cast(vote_share1_7 as float64) vote_share1_7,
    safe_cast(vote_share2_7 as float64) vote_share2_7,
    safe_cast(e_votes_7 as int64) e_votes_7,
    safe_cast(e_vote_share_7 as float64) e_vote_share_7,
    safe_cast(candidate_8 as string) candidate_8,
    safe_cast(party_8 as string) party_8,
    safe_cast(votes1_8 as int64) votes1_8,
    safe_cast(votes2_8 as int64) votes2_8,
    safe_cast(vote_share1_8 as float64) vote_share1_8,
    safe_cast(vote_share2_8 as float64) vote_share2_8,
    safe_cast(e_votes_8 as int64) e_votes_8,
    safe_cast(e_vote_share_8 as float64) e_vote_share_8,
    safe_cast(candidate_9 as string) candidate_9,
    safe_cast(party_9 as string) party_9,
    safe_cast(votes1_9 as int64) votes1_9,
    safe_cast(votes2_9 as int64) votes2_9,
    safe_cast(vote_share1_9 as float64) vote_share1_9,
    safe_cast(vote_share2_9 as float64) vote_share2_9,
    safe_cast(e_votes_9 as int64) e_votes_9,
    safe_cast(e_vote_share_9 as float64) e_vote_share_9,
    safe_cast(candidate_10 as string) candidate_10,
    safe_cast(party_10 as string) party_10,
    safe_cast(votes1_10 as int64) votes1_10,
    safe_cast(votes2_10 as int64) votes2_10,
    safe_cast(vote_share1_10 as float64) vote_share1_10,
    safe_cast(vote_share2_10 as float64) vote_share2_10,
    safe_cast(e_votes_10 as int64) e_votes_10,
    safe_cast(e_vote_share_10 as float64) e_vote_share_10,
    safe_cast(candidate_11 as string) candidate_11,
    safe_cast(party_11 as string) party_11,
    safe_cast(votes1_11 as int64) votes1_11,
    safe_cast(votes2_11 as int64) votes2_11,
    safe_cast(vote_share1_11 as float64) vote_share1_11,
    safe_cast(vote_share2_11 as float64) vote_share2_11,
    safe_cast(e_votes_11 as int64) e_votes_11,
    safe_cast(e_vote_share_11 as float64) e_vote_share_11,
    safe_cast(candidate_12 as string) candidate_12,
    safe_cast(party_12 as string) party_12,
    safe_cast(votes1_12 as int64) votes1_12,
    safe_cast(votes2_12 as int64) votes2_12,
    safe_cast(vote_share1_12 as float64) vote_share1_12,
    safe_cast(vote_share2_12 as float64) vote_share2_12,
    safe_cast(e_votes_12 as int64) e_votes_12,
    safe_cast(e_vote_share_12 as float64) e_vote_share_12,
    safe_cast(candidate_13 as string) candidate_13,
    safe_cast(party_13 as string) party_13,
    safe_cast(votes1_13 as int64) votes1_13,
    safe_cast(votes2_13 as int64) votes2_13,
    safe_cast(vote_share1_13 as float64) vote_share1_13,
    safe_cast(vote_share2_13 as float64) vote_share2_13,
    safe_cast(e_votes_13 as int64) e_votes_13,
    safe_cast(e_vote_share_13 as float64) e_vote_share_13,
    safe_cast(candidate_14 as string) candidate_14,
    safe_cast(party_14 as string) party_14,
    safe_cast(votes1_14 as int64) votes1_14,
    safe_cast(votes2_14 as int64) votes2_14,
    safe_cast(vote_share1_14 as float64) vote_share1_14,
    safe_cast(vote_share2_14 as float64) vote_share2_14,
    safe_cast(e_votes_14 as int64) e_votes_14,
    safe_cast(e_vote_share_14 as float64) e_vote_share_14,
    safe_cast(candidate_15 as string) candidate_15,
    safe_cast(party_15 as string) party_15,
    safe_cast(votes1_15 as int64) votes1_15,
    safe_cast(votes2_15 as int64) votes2_15,
    safe_cast(vote_share1_15 as float64) vote_share1_15,
    safe_cast(vote_share2_15 as float64) vote_share2_15,
    safe_cast(e_votes_15 as int64) e_votes_15,
    safe_cast(e_vote_share_15 as float64) e_vote_share_15,
    safe_cast(candidate_16 as string) candidate_16,
    safe_cast(party_16 as string) party_16,
    safe_cast(votes1_16 as int64) votes1_16,
    safe_cast(votes2_16 as int64) votes2_16,
    safe_cast(vote_share1_16 as float64) vote_share1_16,
    safe_cast(vote_share2_16 as float64) vote_share2_16,
    safe_cast(e_votes_16 as int64) e_votes_16,
    safe_cast(e_vote_share_16 as float64) e_vote_share_16,
    safe_cast(candidate_17 as string) candidate_17,
    safe_cast(party_17 as string) party_17,
    safe_cast(votes1_17 as int64) votes1_17,
    safe_cast(votes2_17 as int64) votes2_17,
    safe_cast(vote_share1_17 as float64) vote_share1_17,
    safe_cast(vote_share2_17 as float64) vote_share2_17,
    safe_cast(e_votes_17 as int64) e_votes_17,
    safe_cast(e_vote_share_17 as float64) e_vote_share_17,
    safe_cast(candidate_18 as string) candidate_18,
    safe_cast(party_18 as string) party_18,
    safe_cast(votes1_18 as int64) votes1_18,
    safe_cast(votes2_18 as int64) votes2_18,
    safe_cast(vote_share1_18 as float64) vote_share1_18,
    safe_cast(vote_share2_18 as float64) vote_share2_18,
    safe_cast(e_votes_18 as int64) e_votes_18,
    safe_cast(e_vote_share_18 as float64) e_vote_share_18,
    safe_cast(candidate_19 as string) candidate_19,
    safe_cast(party_19 as string) party_19,
    safe_cast(votes1_19 as int64) votes1_19,
    safe_cast(votes2_19 as int64) votes2_19,
    safe_cast(vote_share1_19 as float64) vote_share1_19,
    safe_cast(vote_share2_19 as float64) vote_share2_19,
    safe_cast(e_votes_19 as int64) e_votes_19,
    safe_cast(e_vote_share_19 as float64) e_vote_share_19,
    safe_cast(candidate_20 as string) candidate_20,
    safe_cast(party_20 as string) party_20,
    safe_cast(votes1_20 as int64) votes1_20,
    safe_cast(votes2_20 as int64) votes2_20,
    safe_cast(vote_share1_20 as float64) vote_share1_20,
    safe_cast(vote_share2_20 as float64) vote_share2_20,
    safe_cast(e_votes_20 as int64) e_votes_20,
    safe_cast(e_vote_share_20 as float64) e_vote_share_20,
    safe_cast(candidate_21 as string) candidate_21,
    safe_cast(party_21 as string) party_21,
    safe_cast(votes1_21 as int64) votes1_21,
    safe_cast(votes2_21 as int64) votes2_21,
    safe_cast(vote_share1_21 as float64) vote_share1_21,
    safe_cast(vote_share2_21 as float64) vote_share2_21,
    safe_cast(e_votes_21 as int64) e_votes_21,
    safe_cast(e_vote_share_21 as float64) e_vote_share_21,
    safe_cast(candidate_22 as string) candidate_22,
    safe_cast(party_22 as string) party_22,
    safe_cast(votes1_22 as int64) votes1_22,
    safe_cast(votes2_22 as int64) votes2_22,
    safe_cast(vote_share1_22 as float64) vote_share1_22,
    safe_cast(vote_share2_22 as float64) vote_share2_22,
    safe_cast(e_votes_22 as int64) e_votes_22,
    safe_cast(e_vote_share_22 as float64) e_vote_share_22,
    safe_cast(candidate_23 as string) candidate_23,
    safe_cast(party_23 as string) party_23,
    safe_cast(votes1_23 as int64) votes1_23,
    safe_cast(votes2_23 as int64) votes2_23,
    safe_cast(vote_share1_23 as float64) vote_share1_23,
    safe_cast(vote_share2_23 as float64) vote_share2_23,
    safe_cast(e_votes_23 as int64) e_votes_23,
    safe_cast(e_vote_share_23 as float64) e_vote_share_23,
    safe_cast(candidate_24 as string) candidate_24,
    safe_cast(party_24 as string) party_24,
    safe_cast(votes1_24 as int64) votes1_24,
    safe_cast(votes2_24 as int64) votes2_24,
    safe_cast(vote_share1_24 as float64) vote_share1_24,
    safe_cast(vote_share2_24 as float64) vote_share2_24,
    safe_cast(e_votes_24 as int64) e_votes_24,
    safe_cast(e_vote_share_24 as float64) e_vote_share_24,
    safe_cast(candidate_25 as string) candidate_25,
    safe_cast(party_25 as string) party_25,
    safe_cast(votes1_25 as int64) votes1_25,
    safe_cast(votes2_25 as int64) votes2_25,
    safe_cast(vote_share1_25 as float64) vote_share1_25,
    safe_cast(vote_share2_25 as float64) vote_share2_25,
    safe_cast(e_votes_25 as int64) e_votes_25,
    safe_cast(e_vote_share_25 as float64) e_vote_share_25,
    safe_cast(candidate_26 as string) candidate_26,
    safe_cast(party_26 as string) party_26,
    safe_cast(votes1_26 as int64) votes1_26,
    safe_cast(votes2_26 as int64) votes2_26,
    safe_cast(vote_share1_26 as float64) vote_share1_26,
    safe_cast(vote_share2_26 as float64) vote_share2_26,
    safe_cast(e_votes_26 as int64) e_votes_26,
    safe_cast(e_vote_share_26 as float64) e_vote_share_26,
    safe_cast(candidate_27 as string) candidate_27,
    safe_cast(party_27 as string) party_27,
    safe_cast(votes1_27 as int64) votes1_27,
    safe_cast(votes2_27 as int64) votes2_27,
    safe_cast(vote_share1_27 as float64) vote_share1_27,
    safe_cast(vote_share2_27 as float64) vote_share2_27,
    safe_cast(e_votes_27 as int64) e_votes_27,
    safe_cast(e_vote_share_27 as float64) e_vote_share_27,
    safe_cast(candidate_28 as string) candidate_28,
    safe_cast(party_28 as string) party_28,
    safe_cast(votes1_28 as int64) votes1_28,
    safe_cast(votes2_28 as int64) votes2_28,
    safe_cast(vote_share1_28 as float64) vote_share1_28,
    safe_cast(vote_share2_28 as float64) vote_share2_28,
    safe_cast(e_votes_28 as int64) e_votes_28,
    safe_cast(e_vote_share_28 as float64) e_vote_share_28,
    safe_cast(candidate_29 as string) candidate_29,
    safe_cast(party_29 as string) party_29,
    safe_cast(votes1_29 as int64) votes1_29,
    safe_cast(votes2_29 as int64) votes2_29,
    safe_cast(vote_share1_29 as float64) vote_share1_29,
    safe_cast(vote_share2_29 as float64) vote_share2_29,
    safe_cast(e_votes_29 as int64) e_votes_29,
    safe_cast(e_vote_share_29 as float64) e_vote_share_29,
    safe_cast(candidate_30 as string) candidate_30,
    safe_cast(party_30 as string) party_30,
    safe_cast(votes1_30 as int64) votes1_30,
    safe_cast(votes2_30 as int64) votes2_30,
    safe_cast(vote_share1_30 as float64) vote_share1_30,
    safe_cast(vote_share2_30 as float64) vote_share2_30,
    safe_cast(e_votes_30 as int64) e_votes_30,
    safe_cast(e_vote_share_30 as float64) e_vote_share_30,
    safe_cast(candidate_31 as string) candidate_31,
    safe_cast(party_31 as string) party_31,
    safe_cast(votes1_31 as int64) votes1_31,
    safe_cast(votes2_31 as int64) votes2_31,
    safe_cast(vote_share1_31 as float64) vote_share1_31,
    safe_cast(vote_share2_31 as float64) vote_share2_31,
    safe_cast(e_votes_31 as int64) e_votes_31,
    safe_cast(e_vote_share_31 as float64) e_vote_share_31,
    safe_cast(candidate_32 as string) candidate_32,
    safe_cast(party_32 as string) party_32,
    safe_cast(votes1_32 as int64) votes1_32,
    safe_cast(votes2_32 as int64) votes2_32,
    safe_cast(vote_share1_32 as float64) vote_share1_32,
    safe_cast(vote_share2_32 as float64) vote_share2_32,
    safe_cast(e_votes_32 as int64) e_votes_32,
    safe_cast(e_vote_share_32 as float64) e_vote_share_32,
    safe_cast(candidate_33 as string) candidate_33,
    safe_cast(party_33 as string) party_33,
    safe_cast(votes1_33 as int64) votes1_33,
    safe_cast(votes2_33 as int64) votes2_33,
    safe_cast(vote_share1_33 as float64) vote_share1_33,
    safe_cast(vote_share2_33 as float64) vote_share2_33,
    safe_cast(e_votes_33 as int64) e_votes_33,
    safe_cast(e_vote_share_33 as float64) e_vote_share_33,
    safe_cast(candidate_34 as string) candidate_34,
    safe_cast(party_34 as string) party_34,
    safe_cast(votes1_34 as int64) votes1_34,
    safe_cast(votes2_34 as int64) votes2_34,
    safe_cast(vote_share1_34 as float64) vote_share1_34,
    safe_cast(vote_share2_34 as float64) vote_share2_34,
    safe_cast(e_votes_34 as int64) e_votes_34,
    safe_cast(e_vote_share_34 as float64) e_vote_share_34,
    safe_cast(candidate_35 as string) candidate_35,
    safe_cast(party_35 as string) party_35,
    safe_cast(votes1_35 as int64) votes1_35,
    safe_cast(votes2_35 as int64) votes2_35,
    safe_cast(vote_share1_35 as float64) vote_share1_35,
    safe_cast(vote_share2_35 as float64) vote_share2_35,
    safe_cast(e_votes_35 as int64) e_votes_35,
    safe_cast(e_vote_share_35 as float64) e_vote_share_35,
    safe_cast(candidate_36 as string) candidate_36,
    safe_cast(party_36 as string) party_36,
    safe_cast(votes1_36 as int64) votes1_36,
    safe_cast(votes2_36 as int64) votes2_36,
    safe_cast(vote_share1_36 as float64) vote_share1_36,
    safe_cast(vote_share2_36 as float64) vote_share2_36,
    safe_cast(e_votes_36 as int64) e_votes_36,
    safe_cast(e_vote_share_36 as float64) e_vote_share_36,
    safe_cast(candidate_37 as string) candidate_37,
    safe_cast(party_37 as string) party_37,
    safe_cast(votes1_37 as int64) votes1_37,
    safe_cast(votes2_37 as int64) votes2_37,
    safe_cast(vote_share1_37 as float64) vote_share1_37,
    safe_cast(vote_share2_37 as float64) vote_share2_37,
    safe_cast(e_votes_37 as int64) e_votes_37,
    safe_cast(e_vote_share_37 as float64) e_vote_share_37,
    safe_cast(candidate_38 as string) candidate_38,
    safe_cast(party_38 as string) party_38,
    safe_cast(votes1_38 as int64) votes1_38,
    safe_cast(votes2_38 as int64) votes2_38,
    safe_cast(vote_share1_38 as float64) vote_share1_38,
    safe_cast(vote_share2_38 as float64) vote_share2_38,
    safe_cast(e_votes_38 as int64) e_votes_38,
    safe_cast(e_vote_share_38 as float64) e_vote_share_38,
    safe_cast(candidate_39 as string) candidate_39,
    safe_cast(party_39 as string) party_39,
    safe_cast(votes1_39 as int64) votes1_39,
    safe_cast(votes2_39 as int64) votes2_39,
    safe_cast(vote_share1_39 as float64) vote_share1_39,
    safe_cast(vote_share2_39 as float64) vote_share2_39,
    safe_cast(e_votes_39 as int64) e_votes_39,
    safe_cast(e_vote_share_39 as float64) e_vote_share_39,
    safe_cast(flag_two_round as bool) flag_two_round,
    safe_cast(flag_inconsequential as bool) flag_inconsequential,
    safe_cast(flag_inconsequential_note as string) flag_inconsequential_note,
    safe_cast(flag_coup as bool) flag_coup,
    safe_cast(flag_plebiscite as bool) flag_plebiscite,
    safe_cast(flag_unopposed as bool) flag_unopposed,
    safe_cast(flag_indirect as bool) flag_indirect
from {{ set_datalake_project("us_harvard_ned_staging.presidential_elections") }} as t
