---
name: Triggers Elementary Models
on:
  schedule:
    - cron: 00 23 * * 1
  workflow_dispatch:
jobs:
  run_elementary_models:
    name: Run elementary model
    runs-on: ubuntu-22.04
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        with:
          ref: ${{ github.head_ref }}
      - name: Install uv
        uses: astral-sh/setup-uv@v5
      - name: Set up Python
        run: uv python install
      - name: Install dependencies
        run: uv sync --locked --only-dev
      - name: Run prefect flow to execute dbt model for elementary
        run: |-
          uv run .github/workflows/scripts/prefect_run_dbt.py \
            --dbt-command run \
            --dataset-id elementary \
            --prefect-backend-token ${{ secrets.PREFECT_BACKEND_AUTH_TOML_API_KEY }}
